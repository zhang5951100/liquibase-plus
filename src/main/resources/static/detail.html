<!DOCTYPE html>
<html lang="en">
<head>
    <title>Liquibase Plus</title>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <link rel="icon" type="image/x-icon" href="../favicon.ico"/>
    <link href="semantic/dist/semantic.min.css" rel="stylesheet"/>
    <link href="plugins/ionicons/css/ionicons.min.css" rel="stylesheet"/>
    <link href="css/main.css" rel="stylesheet"/>
    <link href="plugins/pacejs/pace.css" rel="stylesheet"/>
</head>
<body>
<div id="contextWrap">
    <!--sidebar-->
    <div class="ui sidebar vertical left menu overlay  borderless visible sidemenu inverted  grey"
         style="-webkit-transition-duration: 0.1s; transition-duration: 0.1s;" data-color="grey">
        <a class="item logo" href="index.html">
            <img src="img/logo.png" alt="stagblogo"/><img src="img/thumblogo.png" alt="stagblogo" class="displaynone"/>
        </a>
        <div class="ui accordion inverted">
            <div class="title item">
                <i class="home titleIcon icon"></i>
                <i class="dropdown icon"></i> 主页
            </div>
            <div class="content">
                <a class="item" href="index.html">
                    Index
                </a>
            </div>
            <div class="title item">
                <i class="list layout titleIcon icon"></i>
                <i class="dropdown icon"></i> 配置详情
            </div>
            <div class="content">
                <a class="item" href="detail.html">
                    Detail
                </a>
            </div>
            <div class="title item">
                <i class="ion-paintbrush titleIcon icon"></i>
                <i class="dropdown icon"></i> 日志
            </div>
            <div class="content">
                <a class="item" href="log.html">
                    Log
                </a>
            </div>
        </div>

        <div class="ui dropdown item displaynone scrolling">
            <span>主页</span>
            <i class="home icon"></i>
            <div class="menu">
                <div class="header">
                    主页
                </div>
                <div class="ui divider"></div>
                <a class="item" href="index.html">
                    Index
                </a>
            </div>
        </div>
        <div class="ui dropdown item displaynone scrolling">
            <span>配置详情</span>
            <i class="list layout  icon"></i>
            <div class="menu">
                <div class="header">
                    配置详情
                </div>
                <div class="ui divider"></div>
                <a class="item" href="detail.html">
                    Detail
                </a>
            </div>
        </div>
        <div class="ui dropdown item displaynone scrolling">
            <span>日志</span>
            <i class="ion-paintbrush  icon"></i>
            <div class="menu">
                <div class="header">
                    日志列表
                </div>
                <div class="ui divider"></div>
                <a class="item" href="log.html">
                    Log
                </a>
            </div>
        </div>
    </div>
    <!--sidebar-->
    <div class="ui right sidebar">
        <div style="text-align: center;padding: 25px">

            <h5 class="ui header">导航栏颜色</h5>

            <div>

                <ul class="colorlist">
                    <li>
                        <a class="ui segment yellow inverted" data-addClass="inverted yellow">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment red inverted" data-addClass="inverted red">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment blue inverted" data-addClass="inverted blue">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment black inverted" data-addClass="inverted black">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment orange inverted" data-addClass="inverted orange">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment pink inverted" data-addClass="inverted pink">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment green inverted" data-addClass="inverted green">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment purple inverted" data-addClass="inverted purple">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment violet inverted" data-addClass="inverted violet">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment brown inverted" data-addClass="inverted brown">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment teal inverted" data-addClass="inverted teal">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment greenli inverted" data-addClass="inverted greenli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment grey inverted" data-addClass="inverted grey">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment redli inverted" data-addClass="inverted redli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment yellowli inverted" data-addClass="inverted yellowli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment blueli inverted" data-addClass="inverted blueli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment darkpurpleli inverted" data-addClass="inverted darkpurpleli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment darkorangeli inverted" data-addClass="inverted darkorangeli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment greenli2 inverted" data-addClass="inverted greenli2">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment pinkli inverted" data-addClass="inverted pinkli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment lightyellowli inverted" data-addClass="inverted lightyellowli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment darkli inverted" data-addClass="inverted darkli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment lightbrownli inverted" data-addClass="inverted lightbrownli">
                        </a>
                    </li>
                </ul>
            </div>

            <h5 class="ui header">侧边栏</h5>
            <div>

                <ul class="sidecolor">
                    <li>
                        <a class="ui segment yellow inverted" data-addClass="inverted yellow">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment red inverted" data-addClass="inverted red">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment blue inverted" data-addClass="inverted blue">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment black inverted" data-addClass="inverted black">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment orange inverted" data-addClass="inverted orange">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment pink inverted" data-addClass="inverted pink">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment green inverted" data-addClass="inverted green">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment purple inverted" data-addClass="inverted purple">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment violet inverted" data-addClass="inverted violet">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment brown inverted" data-addClass="inverted brown">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment teal inverted" data-addClass="inverted teal">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment greenli inverted" data-addClass="inverted greenli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment grey inverted" data-addClass="inverted grey">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment redli inverted" data-addClass="inverted redli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment yellowli inverted" data-addClass="inverted yellowli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment blueli inverted" data-addClass="inverted blueli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment darkpurpleli inverted" data-addClass="inverted darkpurpleli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment darkorangeli inverted" data-addClass="inverted darkorangeli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment greenli2 inverted" data-addClass="inverted greenli2">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment pinkli inverted" data-addClass="inverted pinkli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment lightyellowli inverted" data-addClass="inverted lightyellowli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment darkli inverted" data-addClass="inverted darkli">
                        </a>
                    </li>
                    <li>
                        <a class="ui segment lightbrownli inverted" data-addClass="inverted lightbrownli">
                        </a>
                    </li>
                </ul>
            </div>

        </div>


    </div>
    <div class="pusher">
        <!--navbar-->
        <div class="navslide navwrap">
            <div class="ui menu icon borderless grid" data-color="inverted white">
                <a class="item labeled openbtn">
                    <i class="ion-navicon-round big icon"></i>
                </a>
                <a class="item labeled expandit" onclick="toggleFullScreen(document.body)">
                    <i class="ion-arrow-expand big icon"></i>
                </a>

                <div class="right menu colhidden">


                    <a class="item labeled rightsidebar computer only">
                        <i class="ion-wrench large icon"></i>
                    </a>

                </div>
            </div>
        </div>

        <div class="mainWrap navslide">
            <div class="stretched row">
                <div style="padding: 10px">
                    <div class="ui fluid form">
                        <div class="two fields">
                            <div class="field">
                                <div class="row" style="width: 650px;">
                                    <div id="init_form" class="sixteen wide tablet eight wide computer column">
                                        <div class="field">
                                            <table class="ui definition table">
                                                <tbody>
                                                <tr>
                                                    <td class="two wide column">Database</td>
                                                    <td id="driver"></td>
                                                </tr>
                                                <tr>
                                                    <td>Url</td>
                                                    <td id="url"></td>
                                                </tr>
                                                <tr>
                                                    <td>Username</td>
                                                    <td id="username"></td>
                                                </tr>
                                                <tr>
                                                    <td>Password</td>
                                                    <td id="password"></td>
                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="ui form segment form5" style="height: 270px;width: 650px;">

                                        <div class="field">
                                            <label>Command(必填)</label>
                                            <div class="ui selection dropdown" tabindex="0">
                                                <input name="command" id="command" type="hidden">
                                                <div class="default text">Command</div>
                                                <i class="dropdown icon"></i>
                                                <div class="menu" tabindex="-1">
                                                    <div class="item" data-value=" update">update</div>
                                                    <div class="item" data-value=" rollback">rollbackTag</div>
                                                    <div class="item" data-value=" rollbackToDate">rollbackToDate</div>
                                                    <div class="item" data-value=" rollbackCount">rollbackCount</div>
                                                    <div class="item" data-value=" dbDoc">dbDoc</div>
                                                    <div class="item" data-value=" generateChangeLog">
                                                        generateChangeLog
                                                    </div>
                                                    <div class="item" data-value=" tag">tag</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="field">
                                            <label>Parameter (选填)</label>
                                            <input placeholder="parameter" id="parameter" name="parameter" type="text">
                                        </div>

                                        <br><br>
                                        <div id="a" class="ui blue submit button" onclick="execute()">执行</div>
                                    </div>
                                </div>
                            </div>
                            <div class="field">
                                <div class="row" style="width: 650px;">
                                    <div class="ui form segment form5" style="width: 600px;">
                                        <h3>ChangeSet</h3>
                                        <div class="two fields">
                                            <div class="field">
                                                <label>ID</label>
                                                <input placeholder="id" id="changeSetId" name="id" type="text">
                                            </div>
                                            <div class="field">
                                                <label>Author</label>
                                                <input placeholder="author" id="changeSetAuthor" type="text">
                                            </div>
                                        </div>

                                        <div id="changeSet_div" class="field">
                                            <label>Option</label>
                                            <div class="ui selection dropdown" tabindex="0">
                                                <input name="option" id="option" type="hidden">
                                                <div class="default text">Option</div>
                                                <i class="dropdown icon"></i>
                                                <div class="menu" tabindex="-1">
                                                    <div class="item" data-value="createTable">createTable</div>
                                                    <div class="item" data-value="tagDatabase">createTag</div>
                                                    <div class="item" data-value="addForeignKeyConstraint">
                                                        addForeignKeyConstraint
                                                    </div>
                                                    <div class="item" data-value="createIndex">createIndex</div>
                                                    <div class="item" data-value="addUniqueConstraint">
                                                        addUniqueConstraint
                                                    </div>
                                                </div>

                                            </div>
                                            <div hidden id="createTable" style="padding-top: 20px">
                                                <label>TableName</label>
                                                <input placeholder="tableName" id="tableName" name="tableName"
                                                       type="text">
                                                <div class="two fields">
                                                    <div class="field">
                                                        <label>PrimaryKey Name</label>
                                                        <input placeholder="PrimaryKey Name" id="primaryKeyName"
                                                               name="columnName"
                                                               type="text">
                                                    </div>
                                                    <div class="field">
                                                        <label>PrimaryKey Type</label>
                                                        <input placeholder="PrimaryKey Type" id="primaryKeyType"
                                                               name="columnType" type="text">
                                                    </div>
                                                </div>
                                                <div class="two fields">
                                                    <div class="field">
                                                        <label>ColumnName</label>
                                                        <input placeholder="columnName" id="columnName_1" type="text">
                                                    </div>
                                                    <div class="field">
                                                        <label>ColumnType</label>
                                                        <input placeholder="columnType" id="columnType_1" type="text">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <br>
                                        <div class="ui blue submit button" onclick="changeSet()">提交</div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>
<!--jquery-->
<script src="js/jquery-2.1.4.min.js"></script>
<!--jquery-->
<!--semantic-->
<script src="semantic/dist/semantic.min.js"></script>
<!--semantic-->
<script src="plugins/cookie/js.cookie.js"></script>
<script src="plugins/nicescrool/jquery.nicescroll.min.js"></script>

<script data-pace-options='{ "ajax": false }' src="plugins/pacejs/pace.js"></script>
<script src="js/customjs/custom-validation.js"></script>
<script src="js/main.js"></script>

<script>
    $(function () {
        $.ajax({
            url: "/command/detail",
            type: "get",
            dataType: "json",
            success: function (data) {
                showData(data);
            },
            error: function (msg) {
                alert("数据异常!");
            }
        });
    });

    //展示数据
    function showData(data) {
        document.getElementById("driver").innerText = data.driver;
        document.getElementById("url").innerText = data.url;
        document.getElementById("username").innerText = data.username;
        document.getElementById("password").innerText = data.password;
    }

    function execute() {
        var cmd = {};
        cmd["command"] = $("#command").val();
        cmd["parameter"] = $("#parameter").val();
        var command = cmd.command;
        if (command != null && command !== "") {
            $.ajax({
                contentType: 'application/json;charset=utf-8',
                url: "/command/execute",
                type: "post",
                data: JSON.stringify(cmd),
                success: function (data) {
                    alert("执行成功!")
                },
                error: function (data) {
                    alert("执行失败!")
                }

            });
        }
    }


    $(document).ready(function () {
        $('#option').change(function () {
            var option = $("#option").val()
            if (option === "createTable") {
                $("#createTable").show()
            } else {
                $("#createTable").hide()
            }
        })
    })


    function changeSet() {
        var pkey = {};
        pkey["name"] = $("#primaryKeyName").val();
        pkey["type"] = $("#primaryKeyType").val();
        pkey["constraints"] = {
            "primaryKey": "true",
            "primaryKeyName": $("#primaryKeyName").val() + $("#tableName").val()
        };

        var column = {};
        column["name"] = $("#columnName_1").val();
        column["type"] = $("#columnType_1").val();

        var table_column = [];
        table_column.push(pkey);
        table_column.push(column);

        var createTable = {};
        createTable["tableName"] = $("#tableName").val();
        createTable["columnList"] = table_column;


        var changeSet = {};
        changeSet["id"] = $("#changeSetId").val();
        changeSet["author"] = $("#changeSetAuthor").val();
        changeSet["createTable"] = createTable;


        if (changeSet != null && changeSet !== "") {
            $.ajax({
                contentType: 'application/json;charset=utf-8',
                url: "/command/changeLog",
                type: "post",
                data: JSON.stringify(changeSet),
                success: function (data) {
                    alert("成功!")
                    // loadDetail()
                },
                error: function (data) {
                    alert("配置有误!")
                }
            });
        }
    }

</script>
</body>
</html>
